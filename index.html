<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Malla Interactiva - Medicina 2024</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #ffe6f0;
      padding: 30px;
    }
    h1 {
      text-align: center;
      color: #cc0066;
    }
    .ciclo {
      margin-bottom: 30px;
    }
    .ciclo h2 {
      color: #000;
    }
    .curso {
      display: inline-block;
      padding: 10px 15px;
      margin: 5px;
      border: 2px solid #cc0066;
      border-radius: 8px;
      background-color: #fff0f5;
      color: #cc0066;
      cursor: pointer;
      transition: 0.3s;
    }
    .curso.aprobado {
      background-color: #ffccdf;
      text-decoration: line-through;
      color: #666;
    }
    .curso.bloqueado {
      opacity: 0.3;
      pointer-events: none;
    }
    #mensajeBanner {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #cc0066;
      color: white;
      padding: 15px 25px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      opacity: 0;
      transition: opacity 0.5s ease-in-out;
      z-index: 1000;
    }
    #guardarBtn {
      position: fixed;
      top: 20px;
      right: 20px;
      background-color: #cc0066;
      color: white;
      padding: 10px 15px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
  </style>
</head>
<body>
  <h1>Malla Interactiva de Medicina 2024</h1>
  <button id="guardarBtn">Guardar Progreso</button>
  <div id="malla"></div>
  <div id="mensajeBanner"></div>

  <script>
    const cursos = [
      { ciclo: 1, id: 'mate', nombre: 'Matem√°tica', prerequisitos: [] },
      { ciclo: 1, id: 'quimica', nombre: 'Qu√≠mica General', prerequisitos: [] },
      { ciclo: 1, id: 'biofisica', nombre: 'Biof√≠sica M√©dica', prerequisitos: [] },
      { ciclo: 1, id: 'biocel', nombre: 'Biolog√≠a Celular', prerequisitos: [] },
      { ciclo: 1, id: 'metodologia', nombre: 'Metodolog√≠a del Aprendizaje Universitario', prerequisitos: [] },
      { ciclo: 1, id: 'introprof', nombre: 'Introducci√≥n a la Profesi√≥n', prerequisitos: [] },
      { ciclo: 1, id: 'com1', nombre: 'Comunicaci√≥n I', prerequisitos: [] },

      { ciclo: 2, id: 'com2', nombre: 'Comunicaci√≥n II', prerequisitos: ['com1'] },
      { ciclo: 2, id: 'biomol', nombre: 'Biolog√≠a Molecular', prerequisitos: ['biocel'] },
      { ciclo: 2, id: 'excretor', nombre: 'Sistema Excretor', prerequisitos: ['quimica', 'biocel'] },
      { ciclo: 2, id: 'bioquimica', nombre: 'Bioqu√≠mica M√©dica', prerequisitos: ['quimica', 'biocel'] },
      { ciclo: 2, id: 'casos1', nombre: 'Casos Integradores I', prerequisitos: [] },
      { ciclo: 2, id: 'locomotor', nombre: 'Aparato Locomotor', prerequisitos: ['biofisica'] },

      { ciclo: 3, id: 'casos2', nombre: 'Casos Integradores II', prerequisitos: ['casos1'] },
      { ciclo: 3, id: 'filo', nombre: 'Filosof√≠a y Pensamiento Cr√≠tico', prerequisitos: [] },
      { ciclo: 3, id: 'repro', nombre: 'Sistema Reproductor', prerequisitos: ['locomotor'] },
      { ciclo: 3, id: 'endocrino', nombre: 'Sistema Endocrino', prerequisitos: ['bioquimica'] },
      { ciclo: 3, id: 'nervioso', nombre: 'Sistema Nervioso', prerequisitos: ['bioquimica', 'biofisica'] },
      { ciclo: 3, id: 'medsoc', nombre: 'Medicina Social y Medio Ambiente', prerequisitos: [] },
      { ciclo: 3, id: 'recursos', nombre: 'Recursos Digitales', prerequisitos: [] },

      { ciclo: 4, id: 'sangre', nombre: 'Sangre y Sistema Inmune', prerequisitos: ['nervioso'] },
      { ciclo: 4, id: 'casos3', nombre: 'Casos Integradores III', prerequisitos: ['casos2'] },
      { ciclo: 4, id: 'respira', nombre: 'Sistema Respiratorio', prerequisitos: ['sangre'] },
      { ciclo: 4, id: 'digestivo', nombre: 'Sistema Digestivo', prerequisitos: ['sangre'] },
      { ciclo: 4, id: 'cardio', nombre: 'Sistema Cardiovascular', prerequisitos: ['sangre'] },
      { ciclo: 4, id: 'genetica', nombre: 'Gen√©tica M√©dica', prerequisitos: ['biomol'] },

      { ciclo: 5, id: 'pato', nombre: 'Patolog√≠a General y Especializada', prerequisitos: ['sangre'] },
      { ciclo: 5, id: 'micro', nombre: 'Microbiolog√≠a y Parasitolog√≠a', prerequisitos: ['sangre'] },
      { ciclo: 5, id: 'epi', nombre: 'Epidemiolog√≠a y Medicina Preventiva', prerequisitos: [] },
      { ciclo: 5, id: 'farma', nombre: 'Farmacolog√≠a', prerequisitos: ['pato'] },
      { ciclo: 5, id: 'casos4', nombre: 'Casos Integradores IV', prerequisitos: ['casos3'] },

      { ciclo: 6, id: 'semio', nombre: 'Semiolog√≠a M√©dica', prerequisitos: ['pato'] },
      { ciclo: 6, id: 'pac1', nombre: 'M√©dico Paciente I', prerequisitos: [] },
      { ciclo: 6, id: 'imagen', nombre: 'Diagn√≥stico por Im√°genes y Lab. Cl√≠nico', prerequisitos: [] },
      { ciclo: 6, id: 'info', nombre: 'Inform√°tica M√©dica y Bioestad√≠stica', prerequisitos: [] },
      { ciclo: 6, id: 'fisio', nombre: 'Fisiopatolog√≠a', prerequisitos: ['pato'] },

      { ciclo: 7, id: 'med1', nombre: 'Medicina I', prerequisitos: ['semio'] },
      { ciclo: 7, id: 'evi', nombre: 'Medicina Basada en Evidencias e IA', prerequisitos: [] },
      { ciclo: 7, id: 'pac2', nombre: 'M√©dico Paciente II', prerequisitos: ['pac1'] },
      { ciclo: 7, id: 'etica', nombre: '√âtica y Deontolog√≠a M√©dica', prerequisitos: [] },

      { ciclo: 8, id: 'med2', nombre: 'Medicina II', prerequisitos: ['med1'] },
      { ciclo: 8, id: 'metinv', nombre: 'Metodolog√≠a de la Investigaci√≥n', prerequisitos: [] },
      { ciclo: 8, id: 'pac3', nombre: 'M√©dico Paciente III', prerequisitos: ['pac2'] },
      { ciclo: 8, id: 'psico', nombre: 'Psicolog√≠a M√©dica', prerequisitos: [] },

      { ciclo: 9, id: 'cir1', nombre: 'Cirug√≠a I', prerequisitos: ['med2'] },
      { ciclo: 9, id: 'proj', nombre: 'Proyecto de Investigaci√≥n', prerequisitos: ['metinv'] },
      { ciclo: 9, id: 'multi', nombre: 'M√≥dulo Integrador Multidisciplinario', prerequisitos: [] },
      { ciclo: 9, id: 'elect1', nombre: 'Electivo I', prerequisitos: [] },

      { ciclo: 10, id: 'cir2', nombre: 'Cirug√≠a II', prerequisitos: ['cir1'] },
      { ciclo: 10, id: 'psiq', nombre: 'Psiquiatr√≠a', prerequisitos: [] },
      { ciclo: 10, id: 'tesis1', nombre: 'Tesis I', prerequisitos: ['proj'] },
      { ciclo: 10, id: 'articulo', nombre: 'Redacci√≥n de Art√≠culo Cient√≠fico', prerequisitos: ['proj'] },
      { ciclo: 10, id: 'elect2', nombre: 'Electivo II', prerequisitos: [] },

      { ciclo: 11, id: 'gin', nombre: 'Ginecolog√≠a y Obstetricia', prerequisitos: ['cir2'] },
      { ciclo: 11, id: 'elect2b', nombre: 'Electivo II (opcional)', prerequisitos: [] },
      { ciclo: 11, id: 'global', nombre: 'Salud Global', prerequisitos: [] },
      { ciclo: 11, id: 'legal', nombre: 'Medicina Legal', prerequisitos: [] },

      { ciclo: 12, id: 'pedia', nombre: 'Pediatr√≠a', prerequisitos: ['gin'] },
      { ciclo: 12, id: 'tesis2', nombre: 'Tesis II', prerequisitos: ['tesis1'] },
      { ciclo: 12, id: 'eco', nombre: 'Gerencia y Econom√≠a en Salud', prerequisitos: [] },
      { ciclo: 12, id: 'taller', nombre: 'Taller de Casos Cl√≠nicos', prerequisitos: [] },

      { ciclo: 13, id: 'internado1', nombre: 'Internado de Medicina', prerequisitos: ['pedia'] },
      { ciclo: 13, id: 'internado2', nombre: 'Internado de Pediatr√≠a', prerequisitos: ['pedia'] },

      { ciclo: 14, id: 'internado3', nombre: 'Internado de Ginecobstetricia', prerequisitos: ['internado1'] },
      { ciclo: 14, id: 'internado4', nombre: 'Internado de Cirug√≠a', prerequisitos: ['internado1'] },
    ];

    const mallaDiv = document.getElementById('malla');
    const mensajeBanner = document.getElementById('mensajeBanner');
    const guardarBtn = document.getElementById('guardarBtn');

    function construirCursos() {
      const guardados = JSON.parse(localStorage.getItem('cursosAprobados')) || [];
      cursos.forEach(curso => {
        const cicloId = `ciclo${curso.ciclo}`;
        let divCiclo = document.getElementById(cicloId);

        if (!divCiclo) {
          divCiclo = document.createElement('div');
          divCiclo.classList.add('ciclo');
          divCiclo.id = cicloId;
          divCiclo.innerHTML = `<h2>${curso.ciclo}¬∞ Ciclo</h2>`;
          mallaDiv.appendChild(divCiclo);
        }

        const btn = document.createElement('div');
        btn.classList.add('curso');
        btn.id = curso.id;
        btn.textContent = curso.nombre;
        btn.dataset.prerequisitos = JSON.stringify(curso.prerequisitos);

        if (guardados.includes(curso.id)) {
          btn.classList.add('aprobado');
        }

        divCiclo.appendChild(btn);
      });
    }

    function actualizarEstado() {
      document.querySelectorAll('.curso').forEach(curso => {
        const prereqs = JSON.parse(curso.dataset.prerequisitos);
        const aprobado = curso.classList.contains('aprobado');

        if (prereqs.length > 0 && !aprobado) {
          const habilitado = prereqs.every(id => {
            const el = document.getElementById(id);
            return el && el.classList.contains('aprobado');
          });
          curso.classList.toggle('bloqueado', !habilitado);
        } else if (prereqs.length === 0) {
          curso.classList.remove('bloqueado');
        }
      });
    }

    function mostrarMensaje(nombreCurso) {
      mensajeBanner.textContent = `¬°Felicidades Melina! Has aprobado ¬´${nombreCurso}¬ª. ¬°Sigue adelante! üå∏`;
      mensajeBanner.style.opacity = 1;
      setTimeout(() => {
        mensajeBanner.style.opacity = 0;
      }, 3000);
    }

    document.addEventListener('click', e => {
      if (e.target.classList.contains('curso')) {
        const curso = e.target;
        const fueAprobado = curso.classList.toggle('aprobado');
        if (fueAprobado) mostrarMensaje(curso.textContent);
        actualizarEstado();
      }
    });

    guardarBtn.addEventListener('click', () => {
      const aprobados = Array.from(document.querySelectorAll('.curso.aprobado')).map(c => c.id);
      localStorage.setItem('cursosAprobados', JSON.stringify(aprobados));
      alert('Progreso guardado exitosamente üìù');
    });

    construirCursos();
    actualizarEstado();
  </script>
</body>
</html>
